<!DOCTYPE html>
<html lang="fr">
<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width,initial-scale=1" />
	<title>Documentation - Système de Gestion des Concessions Aquaculture</title>

	<!-- Bootstrap + Font Awesome (reuse CDN used in project) -->
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
	<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">

	<style>
		:root { --brand:#4a8eff; --muted:#6b7280; }
		body { font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif; background:#f8fafc; color:#222; }
		header.doc-header { background: linear-gradient(135deg,var(--brand),#6b9cff); color:white; padding:24px 0; margin-bottom:18px; }
		.doc-container { max-width:1100px; margin:0 auto; padding:18px; }
		.section { margin-bottom:28px; background:white; border-radius:8px; padding:18px; box-shadow:0 2px 10px rgba(15,23,42,0.04); }
		.screenshot { border:1px solid #e9eef8; border-radius:6px; width:100%; max-height:520px; object-fit:contain; display:block; margin-bottom:12px; }
		.toc a { display:block; padding:6px 0; color:var(--brand); text-decoration:none; }
		.controls { display:flex; gap:8px; align-items:center; }
		@media print {
			nav, .controls { display:none !important; }
			body { background: white; }
		}
	</style>
</head>
<body>
	<header class="doc-header">
		<div class="container doc-container d-flex justify-content-between align-items-center">
			<div>
				<h1 class="h3 mb-1">Documentation Technique</h1>
				<div class="small">Système de Gestion des Concessions Aquaculture — Documentation utilisateur & technique</div>
			</div>
			<div class="controls">
				<button class="btn btn-light" id="printBtn" title="Imprimer"><i class="fas fa-print"></i> Imprimer</button>
				<a class="btn btn-primary" href="generate_docs.php" id="generatePdf" title="Générer PDF côté serveur"><i class="fas fa-file-pdf"></i> Générer PDF</a>
			</div>
		</div>
	</header>

	<main class="doc-container">
		<div class="row">
			<aside class="col-md-3 mb-3">
				<div class="section">
					<h5>Table des matières</h5>
					<nav class="toc">
						<a href="#intro">1. Introduction</a>
						<a href="#interface">2. Interface Carte</a>
						<a href="#vertices">3. Gestion des Vertices</a>
						<a href="#zones">4. Gestion des Zones</a>
						<a href="#concessions">5. Gestion des Concessions</a>
						<a href="#features">6. Fonctionnalités</a>
						<a href="#usage">7. Utilisation</a>
						<a href="#notes">8. Notes techniques</a>
					</nav>
				</div>

				<div class="section">
					<h6>Ressources</h6>
					<ul class="list-unstyled small">
						<li><strong>Fichiers de zone:</strong> /zone/*.json</li>
						<li><strong>API Endpoints:</strong> /api.php, /get_coordinates.php</li>
						<li><strong>Données géographiques:</strong> /data/communes.json</li>
						<li><strong>Documentation:</strong> documentation.html</li>
					</ul>
				</div>
			</aside>

			<section class="col-md-9">
				<article id="intro" class="section">
					<h2 class="h5">1. Introduction</h2>
					<p>Le Système de Gestion des Concessions Aquaculture est une application web permettant la gestion, l'édition et la visualisation des zones de concessions aquacoles. Cette documentation présente les écrans principaux, l'édition des vertices, et les fonctionnalités disponibles.</p>
				</article>

				<article id="interface" class="section">
					<h2 class="h5">2. Interface Carte</h2>
					<p>L'interface affiche une carte interactive avec : sélection des couches (Satellite/Carte), visualisation des concessions et interactions (placer un marqueur, afficher popup).</p>

					<!-- screenshot map -->
					<p><img id="s_map" class="screenshot" src="screenshots/map.png" alt="Capture d'écran: carte (map.png)"></p>

					<ul>
						<li>Sélection des couches dans le panneau "Couches".</li>
						<li>Zoom et navigation standard Leaflet.</li>
						<li>Cliquer sur la carte pour placer un marqueur et générer automatiquement un carré de test (coordonnées).</li>
					</ul>
				</article>

				<article id="vertices" class="section">
					<h2 class="h5">3. Gestion des Vertices</h2>
					<p>Les vertices (sommets) des polygones de zone sont modifiables directement :</p>
					<ul>
						<li>Chaque vertex est matérialisé par un point draggable.</li>
						<li>En déplaçant un vertex, la géométrie du polygone est mise à jour en temps réel.</li>
						<li>Un panneau d'édition (Enregistrer / Réinitialiser) apparaît pour persister ou annuler les modifications.</li>
						<li>Clique sur un vertex : copie rapide des coordonnées dans le presse-papiers (si supporté par le navigateur).</li>
					</ul>

					<!-- screenshot vertices -->
					<p><img id="s_vertex" class="screenshot" src="screenshots/vertex.png" alt="Capture d'écran: édition vertices (vertex.png)"></p>
				</article>

				<article id="zones" class="section">
					<h2 class="h5">4. Gestion des Zones</h2>
					<p>Le système permet une gestion avancée des zones :</p>
					<ul>
						<li><strong>Chargement dynamique</strong> des zones depuis des fichiers GeoJSON</li>
						<li><strong>Visualisation interactive</strong> avec surbrillance au survol</li>
						<li><strong>Édition des vertices</strong> par glisser-déposer</li>
						<li><strong>Sauvegarde automatique</strong> des modifications</li>
						<li><strong>Informations détaillées</strong> au clic sur une zone</li>
					</ul>
				</article>

				<article id="concessions" class="section">
					<h2 class="h5">5. Gestion des Concessions</h2>
					<p>Fonctionnalités complètes pour la gestion des concessions :</p>
					<ul>
						<li><strong>Création</strong> de nouvelles concessions avec coordonnées précises</li>
						<li><strong>Visualisation</strong> des concessions existantes sur la carte</li>
						<li><strong>Recherche</strong> par wilaya, commune, ou référence</li>
						<li><strong>Génération</strong> de fiches techniques et d'états de paiement</li>
						<li><strong>Export</strong> des données au format PDF</li>
					</ul>
				</article>

				<article id="features" class="section">
					<h2 class="h5">6. Fonctionnalités Techniques</h2>
					<ul>
						<li><strong>Interface utilisateur</strong> : formulaire de saisie intuitif, multilingue (FR/AR)</li>
						<li><strong>Géolocalisation</strong> : support des formats de coordonnées (Décimal, DMS, UTM)</li>
						<li><strong>Cartographie</strong> : couches multiples, fonds de carte personnalisables</li>
						<li><strong>Sécurité</strong> : validation des entrées, protection contre les injections</li>
						<li><strong>Performance</strong> : chargement asynchrone des données, mise en cache</li>
					</ul>
				</article>

				<article id="usage" class="section">
					<h2 class="h5">7. Guide d'Utilisation</h2>
					<h6>Création d'une nouvelle concession</h6>
					<ol>
						<li>Sélectionner une zone existante ou choisir "Hors zone"</li>
						<li>Cliquer sur la carte pour positionner la concession ou entrer manuellement les coordonnées</li>
						<li>Remplir le formulaire avec les informations de la concession</li>
						<li>Cliquer sur <em>Enregistrer</em> pour sauvegarder</li>
					</ol>

					<h6 class="mt-4">Édition d'une concession existante</h6>
					<ol>
						<li>Sélectionner la concession dans la liste des concessions</li>
						<li>Modifier les coordonnées ou les informations du formulaire</li>
						<li>Cliquer sur <em>Mettre à jour</em> pour sauvegarder les modifications</li>
					</ol>

					<h6 class="mt-4">Génération de documents</h6>
					<ol>
						<li>Sélectionner une concession existante</li>
						<li>Cliquer sur <em>Fiche Technique</em> ou <em>État de Paiement</em></li>
						<li>Le document sera généré au format PDF</li>
					</ol>
				</article>

				<article id="notes" class="section">
					<h2 class="h5">8. Notes Techniques</h2>
					<h6>Spécifications techniques</h6>
					<ul>
						<li><strong>Système de coordonnées :</strong> WGS84 (EPSG:4326)</li>
						<li><strong>Formats supportés :</strong> Décimal, DMS, UTM</li>
						<li><strong>Technologies :</strong> HTML5, CSS3, JavaScript (ES6+), Leaflet.js, Bootstrap 5</li>
						<li><strong>Compatibilité :</strong> Tous les navigateurs modernes (Chrome, Firefox, Safari, Edge)</li>
					</ul>

					<h6 class="mt-4">Structure des dossiers</h6>
					<pre>
/aquaculture/
├── /zone/           # Fichiers GeoJSON des zones
├── /data/           # Données de référence (communes, wilayas)
├── /screenshots/    # Captures d'écran pour la documentation
├── api.php          # API principale
├── index.html       # Application principale
└── documentation.html # Cette documentation
					</pre>

					<h6 class="mt-4">API Endpoints</h6>
					<ul>
						<li><code>GET /api.php?action=list_concessions</code> - Liste des concessions</li>
						<li><code>POST /api.php?action=save_concession</code> - Sauvegarder une concession</li>
						<li><code>GET /get_coordinates.php</code> - Obtenir des coordonnées</li>
						<li><code>GET /list_zone_files.php</code> - Lister les fichiers de zone</li>
					</ul>
				</article>
			</section>
		</div>
	</main>

	<footer class="doc-container text-center small py-4">
		<div> Système de Gestion des Concessions Aquaculture</div>
	</footer>

	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
	<script>
		document.getElementById('printBtn').addEventListener('click', () => window.print());

		// Hide missing screenshots gracefully
		['s_map','s_vertex'].forEach(id => {
			const img = document.getElementById(id);
			if (!img) return;
			img.addEventListener('error', () => {
				img.style.display = 'none';
				const p = document.createElement('div');
				p.className = 'text-muted small';
				p.textContent = 'Capture non trouvée: placez les fichiers dans /screenshots (map.png, vertex.png)';
				img.parentNode.insertBefore(p, img.nextSibling);
			});
		});
	</script>
</body>
</html>
